<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.4" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="alternate" hreflang="zh-cn" href="https://docs.ZLMediaKit.com/zh/reference/documents/exclusive_features.html"><meta property="og:url" content="https://docs.ZLMediaKit.com/reference/documents/exclusive_features.html"><meta property="og:site_name" content="ZLMediaKit"><meta property="og:title" content="Exclusive Features of ZLMediakit"><meta property="og:description" content="1. Play before Publishing Pain point: Unable to play before successful publishing.; Scenario:; In some real-time streaming scenarios, there is a need for simultaneous streaming ..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:locale:alternate" content="zh-CN"><meta property="og:updated_time" content="2023-12-05T08:36:26.000Z"><meta property="article:author" content="ZLMediaKit"><meta property="article:modified_time" content="2023-12-05T08:36:26.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Exclusive Features of ZLMediakit","image":[""],"dateModified":"2023-12-05T08:36:26.000Z","author":[{"@type":"Person","name":"ZLMediaKit","url":"https://docs.ZLMediaKit.com"}]}</script><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-touch-icon-152x152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Exclusive Features of ZLMediakit | ZLMediaKit</title><meta name="description" content="1. Play before Publishing Pain point: Unable to play before successful publishing.; Scenario:; In some real-time streaming scenarios, there is a need for simultaneous streaming ...">
    <link rel="preload" href="/assets/style-KfF5r-mO.css" as="style"><link rel="stylesheet" href="/assets/style-KfF5r-mO.css">
    <link rel="modulepreload" href="/assets/app-CRnFokh3.js"><link rel="modulepreload" href="/assets/exclusive_features.html-BdKYueX9.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js"><link rel="modulepreload" href="/assets/exclusive_features.html-CYP6OSPD.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="ZLMediaKit"><!----><span class="vp-site-name hide-in-pad">ZLMediaKit</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="Home" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="Guide" class="vp-link nav-link nav-link" href="/guide/"><span class="font-icon icon fa-fw fa-sm fas fa-terminal" style=""></span>Guide<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="Tutorial" class="vp-link nav-link nav-link" href="/tutorial/"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>Tutorial<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="Reference"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>Reference</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="Testing" class="vp-link nav-link nav-link" href="/reference/test.html"><span class="font-icon icon fa-fw fa-sm fas fa-vials" style=""></span>Testing<!----></a></li><li class="dropdown-item"><a aria-label="Resources" class="vp-link nav-link nav-link" href="/reference/resources.html"><span class="font-icon icon fa-fw fa-sm fas fa-font-awesome" style=""></span>Resources<!----></a></li><li class="dropdown-item"><a aria-label="Related documents" class="vp-link nav-link active nav-link active" href="/reference/documents.html"><span class="font-icon icon fa-fw fa-sm fas fa-file-code" style=""></span>Related documents<!----></a></li><li class="dropdown-item"><a aria-label="Development log" class="vp-link nav-link nav-link" href="/reference/development_log.html"><span class="font-icon icon fa-fw fa-sm fas fa-code-commit" style=""></span>Development log<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="More"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>More</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="Collaborative Projects" class="vp-link nav-link nav-link" href="/more/collaborative_projects.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Collaborative Projects<!----></a></li><li class="dropdown-item"><a aria-label="License" class="vp-link nav-link nav-link" href="/more/license.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>License<!----></a></li><li class="dropdown-item"><a aria-label="Acknowledgments" class="vp-link nav-link nav-link" href="/more/thanks.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Acknowledgments<!----></a></li><li class="dropdown-item"><a aria-label="Contact US" class="vp-link nav-link nav-link" href="/more/contact.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Contact US<!----></a></li><li class="dropdown-item"><a aria-label="Use Cases" class="vp-link nav-link nav-link" href="/more/use_cases.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Use Cases<!----></a></li></ul></button></div></div></nav><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="English" class="vp-link nav-link active nav-link active" href="/reference/documents/exclusive_features.html"><!---->English<!----></a></li><li class="dropdown-item"><a aria-label="简体中文" class="vp-link nav-link nav-link" href="/zh/reference/documents/exclusive_features.html"><!---->简体中文<!----></a></li></ul></button></div></div><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/ZLMediaKit/ZLMediaKit" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Home" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>Home<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Tutorial" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tutorial/"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>Tutorial<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Docs</span><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Guide" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/guide/"><span class="font-icon icon fa-fw fa-sm fas fa-terminal" style=""></span>Guide<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-gears" style=""></span><span class="vp-sidebar-title">Media Server</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><span class="vp-sidebar-title">Code interpretation</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-question" style=""></span><span class="vp-sidebar-title">FAQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-box-archive" style=""></span><span class="vp-sidebar-title">Install</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span><span class="vp-sidebar-title">Protocol</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span><span class="vp-sidebar-title">SDK API</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable active"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a aria-label="Reference" class="vp-link nav-link active vp-sidebar-title nav-link active vp-sidebar-title" href="/reference/"><!---->Reference<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-code-commit" style=""></span><span class="vp-sidebar-title">Development log</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-file-code" style=""></span><span class="vp-sidebar-title">Related documents</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Related documents" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/reference/documents/"><span class="font-icon icon fa-fw fa-sm fas fa-file-code" style=""></span>Related documents<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Exclusive Features of ZLMediakit" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/reference/documents/exclusive_features.html"><!---->Exclusive Features of ZLMediakit<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1. Play before Publishing" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_1-play-before-publishing"><!---->1. Play before Publishing<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2. No Viewer Event" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_2-no-viewer-event"><!---->2. No Viewer Event<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3. Stream Not Found Event" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_3-stream-not-found-event"><!---->3. Stream Not Found Event<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4. Reconnect after disconnection and continue pushing stream" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_4-reconnect-after-disconnection-and-continue-pushing-stream"><!---->4. Reconnect after disconnection and continue pushing stream<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5. Cluster Deployment" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_5-cluster-deployment"><!---->5. Cluster Deployment<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6. WebRTC Single Port, Multi-threading, and Connection Migration Support" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_6-webrtc-single-port-multi-threading-and-connection-migration-support"><!---->6. WebRTC Single Port, Multi-threading, and Connection Migration Support<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7. Long Connection for HLS Playback" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/reference/documents/exclusive_features.html#_7-long-connection-for-hls-playback"><!---->7. Long Connection for HLS Playback<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="RTSP push streaming process" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/reference/documents/rtsp_push_process.html"><!---->RTSP push streaming process<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="The Essence of Live Streaming Delay" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/reference/documents/the_nature_of_live_broadcast_delay.html"><!---->The Essence of Live Streaming Delay<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ZLMediaKit高并发实现原理" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/reference/documents/high_concurrency_implementation_principle.html"><!---->ZLMediaKit高并发实现原理<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="流媒体相关技术介绍" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/reference/documents/introduction_to_streaming_media_related_technologies.html"><!---->流媒体相关技术介绍<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-font-awesome" style=""></span><span class="vp-sidebar-title">Resources</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-vials" style=""></span><span class="vp-sidebar-title">Testing</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a aria-label="More" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/more/"><!---->More<!----></a><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Acknowledgments" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/more/thanks.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Acknowledgments<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Collaborative Projects" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/more/collaborative_projects.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Collaborative Projects<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Contact US" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/more/contact.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Contact US<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="License" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/more/license.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>License<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Use Cases" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/more/use_cases.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Use Cases<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Exclusive Features of ZLMediakit</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://docs.ZLMediaKit.com" target="_blank" rel="noopener noreferrer">ZLMediaKit</a></span><span property="author" content="ZLMediaKit"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-11-19T19:55:59.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 7 min</span><meta property="timeRequired" content="PT7M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_1-play-before-publishing">1. Play before Publishing</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_2-no-viewer-event">2. No Viewer Event</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_3-stream-not-found-event">3. Stream Not Found Event</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_4-reconnect-after-disconnection-and-continue-pushing-stream">4. Reconnect after disconnection and continue pushing stream</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_5-cluster-deployment">5. Cluster Deployment</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_6-webrtc-single-port-multi-threading-and-connection-migration-support">6. WebRTC Single Port, Multi-threading, and Connection Migration Support</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_7-long-connection-for-hls-playback">7. Long Connection for HLS Playback</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="_1-play-before-publishing" tabindex="-1"><a class="header-anchor" href="#_1-play-before-publishing" aria-hidden="true">#</a> 1. Play before Publishing</h2><ul><li><p>Pain point: Unable to play before successful publishing.</p></li><li><p>Scenario:</p><p>In some real-time streaming scenarios, there is a need for simultaneous streaming and playback, typically in a one-to-one setting. For example, in a car recorder based on RTMP streaming, when a user requests to view the live video from the onboard camera and sends a publishing command to the device, the playback of the video starts simultaneously. If the playback request arrives at the media server before the publishing, the server usually returns an error indicating that the stream is not found. To solve this problem, a common approach is to confirm the successful publishing before starting the playback. However, this often increases the delay in opening the video, resulting in a poor user experience. ZLMediakit optimizes this scenario by allowing the server to hold the player&#39;s response if the stream does not exist, and only returns a successful playback response after the publishing is successful. If the publishing does not come online within a timeout period, an error indicating the stream is not found is returned. The delay can be modified through the configuration file:</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">general</span><span class="token punctuation">]</span></span>
<span class="token comment"># Maximum waiting time for playback in milliseconds</span>
<span class="token comment"># When playing a stream that does not exist, ZLMediaKit will allow the player to wait for a maximum of maxStreamWaitMS milliseconds</span>
<span class="token comment"># If the stream is registered successfully within this time, it will immediately return a successful playback response to the player</span>
<span class="token comment"># Otherwise, it returns an error indicating that the stream is not found to the player</span>
<span class="token comment"># The purpose of this mechanism is to enable playback before publishing</span>
<span class="token key attr-name">maxStreamWaitMS</span><span class="token punctuation">=</span><span class="token value attr-value">15000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note: This feature also applies to pulling streams, allowing on-demand publishing and pulling of streams.</p></blockquote></li></ul><h2 id="_2-no-viewer-event" tabindex="-1"><a class="header-anchor" href="#_2-no-viewer-event" aria-hidden="true">#</a> 2. No Viewer Event</h2><ul><li><p>Pain point: Wasting bandwidth when streaming has no viewers.</p></li><li><p>Scenario:</p><p>In some Internet of Things (IoT) applications, a device streams to the server, and users view the device&#39;s video through an app. When users close the app, the device should stop streaming to save bandwidth. The common solution is to have the player send periodic heartbeats to keep the device streaming. However, this often leads to uncertainty in the state and increases system complexity (imagine having to maintain streaming heartbeats for the app, web, and mini-program simultaneously). To address this scenario, ZLMediakit provides a playback user statistics feature. When the viewer count reaches zero, it triggers a no viewer event. By receiving the hook (HTTP request) from ZLMediakit, you can decide whether to close the streaming (or pulling) on ZLMediakit&#39;s side. The hook address is configured in the following file:</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">hook</span><span class="token punctuation">]</span></span>
<span class="token comment"># Enable hook events. When enabled, authentication will be applied to publishing and pulling streams.</span>
<span class="token key attr-name">enable</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token comment"># Event triggered when there are no viewers for a stream. With this event, you can choose whether to close the stream with no viewers.</span>
<span class="token comment"># Use together with the general.streamNoneReaderDelayMS option.</span>
<span class="token key attr-name">on_stream_none_reader</span><span class="token punctuation">=</span><span class="token value attr-value">https://127.0.0.1/index/hook/on_stream_none_reader</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note: Introduction to hooks can be found <a href="/guide/media_server/web_hook_api.html#13onstreamnonereader" class="">here</a>.</p></blockquote></li></ul><h2 id="_3-stream-not-found-event" tabindex="-1"><a class="header-anchor" href="#_3-stream-not-found-event" aria-hidden="true">#</a> 3. Stream Not Found Event</h2><ul><li><p>Pain point: We only want to provide the playback URL, nothing else!</p></li><li><p>Scenario:</p><p>Typically, we distribute video content through playback URLs. However, these video contents are generated in real-time and do not exist when there are no viewers (no publishing or pulling proxies). In such scenarios, the usual practice is to restrict the clients. Instead of providing a playback URL directly, an API for obtaining the URL is provided. Users first obtain the playback URL to trigger the device&#39;s publishing, and then they can start playback. This approach is usually cumbersome, requiring specific pre-playback logic and limiting some application scenarios. ZLMediakit provides a stream not found event, allowing you to report to your business server that the stream does not exist. At this point, you can take control and start the device&#39;s publishing process at your convenience, or let ZLMediakit start pulling the stream. The hook address is configured in the following file:</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">hook</span><span class="token punctuation">]</span></span>
<span class="token comment"># Enable hook events. When enabled, authentication will be applied to publishing and pulling streams.</span>
<span class="token key attr-name">enable</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token comment"># Event triggered when a stream is not found during playback.</span>
<span class="token comment"># With this event, you can complete on-demand pulling by using it in conjunction with the hook.on_stream_none_reader event.</span>
<span class="token key attr-name">on_stream_not_found</span><span class="token punctuation">=</span><span class="token value attr-value">https://127.0.0.1/index/hook/on_stream_not_found</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note: Introduction to hooks can be found <a href="/guide/media_server/web_hook_api.html#14on_stream_not_found" class="">here</a>.</p></blockquote></li></ul><h2 id="_4-reconnect-after-disconnection-and-continue-pushing-stream" tabindex="-1"><a class="header-anchor" href="#_4-reconnect-after-disconnection-and-continue-pushing-stream" aria-hidden="true">#</a> 4. Reconnect after disconnection and continue pushing stream</h2><ul><li><p>Pain point: When the pushing stream is disconnected and the pushing stream device reconnects, all the players are disconnected as well.</p></li><li><p>Scenario description:</p><p>When a pushing stream device is disconnected, there are several ways for the server to handle the players. One approach, which is the default behavior of zlmediakit, is to immediately disconnect all players who are playing the stream and destroy the streaming device and player objects to save resources. Another approach, represented by SRS, does almost nothing when the streaming device is disconnected. It doesn&#39;t reclaim the resources allocated by the streaming device and doesn&#39;t disconnect the players (instead, it allows the players to time out and disconnect automatically).</p><p>The advantage of SRS&#39;s approach is that when the pushing stream device reconnects, the players can continue playing, providing a better user experience. The downside is that resources are not reclaimed in a timely manner. If there are malicious connections that don&#39;t time out actively, it may consume a large number of file descriptors on the server. Additionally, the media source resources created by the pushing stream device cannot be released actively. When multiple pushing stream devices are created, the memory usage cannot be reduced promptly.</p><p>In response to this scenario, zlmediakit has added support for continuous disconnection and reconnection to address the issue of player disconnection caused by streaming reconnection, as well as the problem of unrecycled resources. The approach is to delay the destruction of the media source resource object (and the disconnection of the player) when the streaming device is disconnected. When the streaming device reconnects, the same resource object is reused, allowing the player to continue watching the video. If the streaming device doesn&#39;t come online after a timeout, the player is disconnected and all resources are reclaimed. The timeout delay is configured as follows:</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">general</span><span class="token punctuation">]</span></span>
<span class="token comment"># After a pushing stream device is disconnected, it can reconnect within the timeout period and resume pushing stream. This allows the player to continue playing.</span>
<span class="token comment"># Set to 0 to disable this feature (disconnection of the pushing stream device will lead to immediate disconnection of the player).</span>
<span class="token comment"># This parameter should not exceed the player timeout.</span>
<span class="token key attr-name">continue_push_ms</span><span class="token punctuation">=</span><span class="token value attr-value">15000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Implementation code snippet:</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">RtmpSession</span><span class="token double-colon punctuation">::</span><span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">const</span> SockException<span class="token operator">&amp;</span> err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Omit irrelevant code</span>

    <span class="token function">GET_CONFIG</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token punctuation">,</span> continue_push_ms<span class="token punctuation">,</span> General<span class="token double-colon punctuation">::</span>kContinuePushMS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_push_src <span class="token operator">&amp;&amp;</span> continue_push_ms<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Release ownership of the pushing stream object</span>
        _push_src_ownership <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> push_src <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>_push_src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Delayed destruction of the object (unregister the stream and trigger disconnection of all players)</span>
        <span class="token function">getPoller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">doDelayTask</span><span class="token punctuation">(</span>continue_push_ms<span class="token punctuation">,</span> <span class="token punctuation">[</span>push_src<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">RtmpSession</span><span class="token double-colon punctuation">::</span><span class="token function">onCmd_publish</span><span class="token punctuation">(</span>AMFDecoder <span class="token operator">&amp;</span>dec<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Omit a large amount of irrelevant code</span>
  <span class="token keyword">auto</span> src <span class="token operator">=</span> <span class="token class-name">MediaSource</span><span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span>RTMP_SCHEMA<span class="token punctuation">,</span> _media_info<span class="token punctuation">.</span>_vhost<span class="token punctuation">,</span> _media_info<span class="token punctuation">.</span>_app<span class="token punctuation">,</span> _media_info<span class="token punctuation">.</span>_streamid<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Attempt to continue pushing stream after disconnection</span>
    <span class="token keyword">auto</span> rtmp_src <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_pointer_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>RtmpMediaSourceImp<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rtmp_src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// The source is not generated by RTMP pushing stream</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">auto</span> ownership <span class="token operator">=</span> rtmp_src<span class="token operator">-&gt;</span><span class="token function">getOwnership</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ownership<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Failed to acquire ownership of the pushing stream source</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Reuse the previous pushing stream resource object</span>
    _push_src <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>rtmp_src<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Take ownership of the object</span>
    _push_src_ownership <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>ownership<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Omit a large amount of irrelevant code</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note: Continuous disconnection and reconnection feature supports RTSP/RTMP/WebRTC pushing stream.</p></blockquote></li></ul><h2 id="_5-cluster-deployment" tabindex="-1"><a class="header-anchor" href="#_5-cluster-deployment" aria-hidden="true">#</a> 5. Cluster Deployment</h2><ul><li><p>Pain point: Limited traceability methods, edge servers cannot use HLS.</p></li><li><p>Scenario description:</p><p>In general, media streaming clusters are implemented using a traceability method, where servers are divided into origin servers and edge servers. The origin server is typically used to receive streams and does not directly handle user playback requests. Instead, it distributes the streams to edge servers, which in turn deliver them to the players. This model supports a large number of user playback requests. SRS has supported this functionality through configuration files for a long time. Since zlmediakit also provides on-demand pulling of streams, it essentially supports the traceability mode for clustering. However, users need to integrate with hooks and APIs, which has a higher development threshold. Therefore, zlmediakit recently added support for cluster mode through configuration files. The configuration file is as follows:</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">cluster</span><span class="token punctuation">]</span></span>
<span class="token comment"># Set the template for the pull stream URL of the origin server. The format is similar to printf, where the first %s specifies the app and the second %s specifies the stream_id.</span>
<span class="token comment"># When cluster mode is enabled, the on_stream_not_found and on_stream_none_reader hooks will be ineffective.</span>
<span class="token comment"># The following types are supported for pull streaming:</span>
<span class="token comment"># rtmp: rtmp://127.0.0.1:1935/%s/%s</span>
<span class="token comment"># rtsp: rtsp://127.0.0.1:554/%s/%s</span>
<span class="token comment"># hls: http://127.0.0.1:80/%s/%s/hls.m3u8</span>
<span class="token comment"># http-ts: http://127.0.0.1:80/%s/%s.live.ts</span>
<span class="token comment"># Multiple origin servers are supported, and different servers are separated by semicolons (;)</span>
  <span class="token key attr-name">origin_url</span><span class="token punctuation">=</span>
<span class="token comment"># Total timeout for pull streaming, in seconds (float). If there are 3 origin servers, the timeout for each individual server will be timeout_sec divided by 3.</span>
<span class="token comment"># The individual server timeout should not exceed the general.maxStreamWaitMS configuration.</span>
  <span class="token key attr-name">timeout_sec</span><span class="token punctuation">=</span><span class="token value attr-value">15</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ZLMediakit supports multiple ways of pulling streams, including rtsp/rtmp/hls/http-ts/http-flv. The methods are diverse and rich, and the origin servers are not divided into primary and backup. Load balancing of the origin servers is achieved using the round-robin method. It should be noted that since ZLMediakit has long supported on-demand streaming for HLS, its edge stations also support the HLS protocol (in fact, they support any protocol supported by ZLMediakit), which is not available in SRS.</p><p>Furthermore, it should be noted that ZLMediakit supports both RTSP and WebRTC, both of which are based on RTP. Internally in ZLMediakit, they can be interconnected without the need for protocol conversion and complex multiplexing/demultiplexing logic. This makes it possible to use ZLMediakit for large-scale, low-latency WebRTC live streaming. Compared to traditional CDN based on RTMP, RTSP is more suitable as the underlying transport protocol for WebRTC. Developers do not need to deal with cumbersome multiplexing/demultiplexing logic and can smoothly achieve the interconversion between RTSP and WebRTC.</p></li></ul><h2 id="_6-webrtc-single-port-multi-threading-and-connection-migration-support" tabindex="-1"><a class="header-anchor" href="#_6-webrtc-single-port-multi-threading-and-connection-migration-support" aria-hidden="true">#</a> 6. WebRTC Single Port, Multi-threading, and Connection Migration Support</h2><ul><li><p>Pain points: Webrtc servers that support multi-threading do not support single port, and those that support single port do not support multi-threading (and may not support connection migration).</p></li><li><p>Scenario introduction:</p><p>Since WebRTC transmission is based on the UDP protocol, traditional WebRTC servers operate in multi-port mode, such as Janus and mediasoup. This brings great pain to deployment and management. Moreover, due to the limited number of ports (the theoretical limit is over 60,000), each WebRTC client occupies 1 to 4 ports. Limited by the number of ports, a WebRTC server can host a maximum of 10,000 to 60,000 clients.</p><p>On the other hand, WebRTC servers that support single port (such as SRS) do not support multi-threading. Due to the much higher computational complexity (encryption/decryption) of WebRTC compared to live streaming, single-threaded performance is often insufficient for WebRTC applications.</p><p>ZLMediakit proposes the best solution for these pain points:</p><ul><li>Support deployment on a single UDP port, where one UDP port handles all clients.</li><li>Support multi-threading on a single UDP port. Each client is assigned a unique fd through repeated bind/connect operations, and the fds are evenly distributed among different threads.</li><li>When a user&#39;s network migrates (e.g., switching from Wi-Fi to 4G), the user is locked using STUN packets, enabling seamless connection migration without interrupting the user experience.</li></ul><p>ZLMediakit is the only open-source solution that combines all three of the above features.</p><blockquote><p>Note: For how to solve the thread safety issue during WebRTC single-port connection migration and multi-threaded connection migration, please watch this <a href="https://mp.weixin.qq.com/s?t=pages/video_detail_new&amp;scene=23&amp;vid=wxv_2170272938552328197&amp;__biz=MzkzNjI5ODIyMg==&amp;mid=2247483673&amp;idx=1&amp;sn=14bc138d91292a1c256c138c822d9c40&amp;vidsn=#wechat_redirect" target="_blank" rel="noopener noreferrer">video<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote></li></ul><h2 id="_7-long-connection-for-hls-playback" tabindex="-1"><a class="header-anchor" href="#_7-long-connection-for-hls-playback" aria-hidden="true">#</a> 7. Long Connection for HLS Playback</h2><p>ZLMediakit achieves long connection for HLS playback through cookie tracking technology. Based on this feature, ZLMediakit&#39;s HLS server has the following exclusive features:</p><ul><li>HLS playback authentication, and no need for re-authentication during playback.</li><li>HLS playback traffic statistics, which can track the total traffic consumption during playback.</li><li>On-demandI&#39;m sorry, but I couldn&#39;t find any information about a specific ZLMediakit feature called &quot;pull stream URL of the origin server.&quot; ZLMediakit is an open-source streaming media server that provides various features for streaming protocols like RTSP, RTMP, HLS, and WebRTC.</li></ul><p>If you have any specific questions about ZLMediakit or need information on a different feature, please let me know, and I&#39;ll do my best to assist you.</p></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/ZLMediaKit/docs/edit/main/src/reference/documents/exclusive_features.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: liyu7352@gmail.com">Alex</span>,<!--]--><!--[--><span class="contributor" title="email: mister-hope@outlook.com">Mr.Hope</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="Related documents" class="vp-link nav-link active prev nav-link active prev" href="/reference/documents/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-file-code" style=""></span>Related documents</div></a><a aria-label="RTSP push streaming process" class="vp-link nav-link next nav-link next" href="/reference/documents/rtsp_push_process.html"><div class="hint">Next<span class="arrow end"></span></div><div class="link">RTSP push streaming process<!----></div></a></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">MIT Licensed</div><div class="vp-copyright">Copyright © 2024 ZLMediaKit</div></footer></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-CRnFokh3.js" defer></script>
  </body>
</html>
